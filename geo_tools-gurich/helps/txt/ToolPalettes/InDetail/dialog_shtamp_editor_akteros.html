Штамп редактор
<p>Редактор содержимого штампа, поддерживает большой, маленький, ГОСТ штампы.</p>
<p>Основная идея штамп редактора состоит в том что, в пределах одного объекта приходится в чертежи вставлять три вида штампов Большой, Маленький и ГОСТ. Поэтому приходится отдельно заполнять три штампа, конечно копирование вставка несколько снижает проблемность, но не решает. Предлагаю свой способ решения проблемы: один раз создается некий текстовый файл с расширением sht в котором записаны данные объекта а при вставке задается только тип штампа а программа выбирая нужные данные из файла формирует штамп. Как раз для ввода и редактирования содержимого текстового файла и служит данный редактор. Редактор состоит из основного окна ( в нем содержится наиболее полная информащия), имеются также два дополнительных окна чтобы посмотреть и/или подправить данные как они будут выглядеть в маленьком и ГОСТ штампе.</p>
<p>Основное окно редактора выглядит так.</p>
<img src="dialog_shtamp_editor_akteros_dialog_main.png" width="394" height="572" alt="Главное окно">
<p>В названии окна в квадратных скобках указано имя открытого файла в данном случае имя <span class="italic">blank</span> означает что открыт <span class="italic">Новый файл</span> и содерфимое штампа отвечает содержимому прототипа (чистого файла). Если нажать кнопку <span class="bold">Новый</span> содержимое штампа сбросится до такого состояния. Также если у нас есть уже сохраненные файлы шаблонов штампов их можно <span class="bold">Открыть</span> одноименной кнопкой через стандартный диалог открыть. После редактирования файл можно <span class="bold">Сохранить</span> или <span class="bold">Сохранить как...</span> например с другим именем или в другую папку. Если нажать кнопку Сохранить после редактирования бланкового (Нового) файла последует запрос <span class="bold">Сохранить как...</span> Чтобы изменить содержимое &quot;чистого&quot; штампа нужно поменять файл <span class="italic">C:\Documents and Settings\[имя пользователя]\Application Data\geo_tools\template\blank.sht</span> это и есть собственно шаблонный штамп. Каждая ячейка штампа при вставке имеет собственное форматирование и размер шрифта. Некоторые поля редактора при вставке штампа объединяются по возможности используется автоперенос по словам в пределах ячейки штампа при вставке. Главное или основное окно редактора соответствует <span class="italic">Большому</span> штампу в нем присутствуют все дааные которые будут нужны в <span class="italic">маленьком</span> но некоторые графы унакальны для <span class="italic">ГОСТ</span> штампа. После вставки Большой штамп будет выглядеть так.</p>
<img src="dialog_shtamp_editor_akteros_big_real.png" width="565" height="565" alt="Большой штамп после вставки">
<p>Для проверки правильно перенесенной информации, а текже добавления не достающих данных в ГОСТ штамп следует нажать кнопку ГОСТ. Появится такое окно.</p>
<img src="dialog_shtamp_editor_akteros_dialog_gost.png" width="632" height="341" alt="Редактор вида ГОСТ">
<p>Большинство данных было взято из основного окна но есть и уникальные. Среди них номер листа: <span class="bold">#</span> - знак решетки (диез) перед цифрой означает, что при каждой вставке штампа эта цифра будет увеличиваться на единицу. После вставки штамп ГОСТ будет выглядеть так</p>
<img src="dialog_shtamp_editor_gost_real.png" width="804" height="245" alt="Штамп ГОСТ после вставки">
<p>Если нажать кнопку Маленький можно посмотреть как введеные данные будут выглядеть в штампе</p>
<p><img src="dialog_shtamp_editor_akteros_dialog_smal.png" width="591" height="141" alt="Редактор вида Маленький"></p>
<p><img src="dialog_shtamp_editor_akteros_smal_real.png" width="565" height="73" alt="Штамп вида Маленький после вставки"></p>
<p>Если нажать кнопку <span class="bold">OK</span> во вспомогательных окнах данные измененные в них обновяться в главном окне, <span class="bold">Отмена</span> отменяет редакцию во вспомогательных окнах. Если нажать <span class="bold">OK</span> в главном окне то текущее состояние ячеек будет сохранено в открытом файле (если открыт blank будет предложено Сохранить как...) и открытый файл примется как текущий. С помощью команд <a href="draw_shtamp_be_property.xxx" >Вставить штамп</a> вставляется именно текущий штамп.</p>