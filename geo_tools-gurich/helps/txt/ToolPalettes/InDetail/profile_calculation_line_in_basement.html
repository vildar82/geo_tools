Вычислить линию на профиле
<p>Вычисляет параметры (длины, уклоны, отметки) линии на профиле и помещает в указанную строку подвала</p>
<p><img class="icon" src="macr.gif" alt="macro"><span class="code">Команда: profile_calculation_line_in_basement</span></p>
<p><img class="icon" src="acad.gif" alt="acad"><span class="code">Текущий профиль:[</span>имя текущего профиля<span class="code">]</span></p>
<p><img class="icon" src="acad.gif" alt="acad"><span class="code">Выбери полилинию на профиле:</span></p>
<p><img class="icon" src="user.gif" alt="user">Указывает 2d полилинию на профиле</p>
<p><span class="code">Укажи заполняемую строку подвала:</span></p>
<p><img class="icon" src="user.gif" alt="user">Указывает точку в строке подвале профиля.</p>
<p>Программа заполняет строку в соответствии с ее типом, например: если строка определена как отметки будет заполнена вычисленными отметками вершин выбранной полилинии, строка расстояний будет заполнена горизонтальными проложениями между вершинами полилинии на профиле и т.д.</p>
<br/>
<p>Одна из причин из за которой я решил написать свои инструменты по созданию профиля это то, что в civil профиле при близком расположении опметки налазиют друг на друга. У меня реализован такой алгоритм нанесения отметок: если тексту отметки ничего не мешает он чертится как задано в настройках высоты текста для данной строки; если мешает близкое расположение другого текста высота текста уменьшается, но не меньше 1.6 мм на бумаге (она считается минимальной по читаемости на бумаге по версии условных знаков, насколько я помню); если не удается вместить текст в 1.6 мм рисуются "паучки" и высота их текста фиксировано 2.0 мм на бумаге.</p>
<p>Пример нормальной и ужатой высоты текста отметки, а так же "паучок", по другим данным "цветочек". :)</p>
<img src="profile_calculation_line_in_basement.png" width="368" height="146" alt="Отметки в строке">
<p>В случае с горизонтальными проложениями несколько иная ситуация: когда все свободно надпись распологается горизонтально как только перстает влезать поворачивается вертикально и уменьшается высота текста но не меньше 1.6 мм на бумаге, в конце концов делается выноска.</p>
<p>Пример подписи горизонтальных проложений.</p>
<p><img src="profile_calculation_line_in_basement_line.png" width="311" height="155" alt="Пример подписи горизонтальных проложений."></p>
<p>С длинной/уклоном та же ситуация: вращением, изменением высоты текста пытается втиснуть в строку выноска как последний вариант, при не возможности сохранить высоту текста 1.6 мм на бумаге.</p>