Оформляем листы
<p><span class="nfield">Дано:</span> есть съемка как правило в виде трассы (линейная) как правило с изгибами и не вдоль X или Y а как раз по диагонали к тому же изгибается. Именно такого под рукой не оказалось поэтому показывать буду на том что есть:</p>
<a href="draw_layout_09.png"><IMG src="draw_layout_09.png" width="650" alt="Пример трассы"></a>
<p><span class="nfield">Надо:</span> оформить документацию по трассе разбив на листы. Дополнительно сдвигать и резать трассу не будем так как теряются координаты, а в случае с моделью рельефа вообще подобно катастрофе. (Есно можно все взорвать, но когда внезапно понадобиться «чуть-чуть подправить» на заключительной стадии будет кисло).</p>
<p>Итак оформление трассы можно разделить на три этапа для каждого используется своя кнопка.</p>
<p><span class="nfield">1. Штамп.</span> Использую три вида штампа: ГОСТ 21-101-97 Форма 3, «Большой» и «Маленький». Данные штампа хранятся в файле .sht и используются для подстановки в нужные места всех штампов.</p>
<p>На практике это выглядит так: команда <span class="ncomm">Штамп редактор</span> открывает текущие данные штампа если запуск происходит первый раз открывается файл по умолчанию [blank] там вбиты какие то древние данные которые нужно отредактировать. Чтобы каждый раз не менять фамилию например главного инженера можно пересохранить файл blank, он находится по пути <span class="nfield">C:\Documents and Settings\&lt;имя пользователя&gt;\Application Data\geo_tools\template\blank.sht</span> Так выглядит окно программы и соответствующий ей тип штампа «Большой»</p>
<a href="draw_layout_01.png" ><IMG src="draw_layout_01.png" width="650" alt="Редакор штампа"></a>
<p>Меняем стандартные данные на свои, чтобы посмотреть как они отобразятся в других штампах есть соответсвующие кнопки ГОСТ </p>
<a href="draw_layout_02.png" ><IMG src="draw_layout_02.png" width="650" alt="Редакор штампа ГОСТ"></a>
<p>и «Маленький».</p>
<IMG src="draw_layout_06.png" width="602" height="224" alt="Редакор штампа Маленький">
<p>Небольшое замечание: если в штампах с номером листа перед цифрой поставить знак # то после каждой вставки штампа это число будет увеличиваться на единицу.</p>
<p>Поменяли нажали <span class="ncomm">OK</span> или <span class="ncomm">Сохранить</span>, будет предложено сохранить файл с расширением .sht по умолчанию название файла такое же как текущий чертеж и предложено сохранить туда же где текущий чертеж находится. Если текущий чертеж еще ни разу не был сохранен будет предложена системная папка Мои документы.
Путь расположения этого sht файла будет записан в чертеже и использоваться при вставке штампов. Если надо вставить штамп отдельно есть кнопки "Вставить штамп ГОСТ", "Вставить штамп Большой", "Вставить штамп Маленький".</p>
<p><span class="nfield">2. Формат листа.</span> В зависимости от конфигурации, размера и масштаба надо вписать объект в лист(ы) определенного формата.  Для этого существует кнопка <span class="ncomm">Менеджер форматов</span> которая позволяет вставить в чертеж формат нужного размера в соответствии с текущем масштабом аннотаций.</p>
<IMG src="draw_layout_07.png" width="229" height="249" alt="Менеджер форматов">
<p>В правой части можно выбрать тип штампа вставляемого вместе с форматом листа. Галочка <span class="ncomm">Поворот</span> позволяет повернуть указанный формат на 90 градусов (ширина и высота поменяются местами). Галочка <span class="ncomm">Вставка штампа с инв.№</span> добавляет в левый нижний угол формата маленький штампик с графами посвящёнными инвентарным номерам.  И последняя галочка самая интересная <span class="ncomm">Без вспомогательных рамок</span>. При работе в листе никакой разницы не играет. В модели: </p>
<p>Галочка поставлена – никаких отличий от работе в листе, вставляется рамка указанного формата с штампом (если указан).</p>
<p>Галочка не поставлена – вставляется вспомогательная рамка указанного листа в которой утолщенной линией показывает внутреннюю границу листа с учетом штампа(если указан) и тонкой линией отступ от этой границы внутрь листа на 5мм в масштабе.</p>
<p>С помощью вспомогательных рамок трасса разбивается на листы. При вставке вспомогательной рамки предполагается что она может быть повернута. Результат будет выглядеть примерно так:</p>
<a href="draw_layout_08.png"><IMG src="draw_layout_08.png" width="650" alt="Пример разбитой на листы трассы"></a>
<p><span class="nfield">3. Автоматическое оформление листов.</span> Должным образом выполненные первые два пункта позволяют автоматически генерировать листы с рамкой, штампом и видовым экраном в нужном масштабе и повернутым изображением.</p>
<p>При активации программа в командной строке сообщит текущие настройки их всего две:</p>
<IMG src="draw_layout_04.png" width="625" height="89" alt="запрос имени листа или настроек">
<p><span class="nfield">Вернуться в модель</span> – <span class="nfield">Да/Нет</span> – действие перехода в модель после созлания листа рамки штампа и видового экрана</p>
<p><span class="nfield">Тип вставляемого штампа</span> – <span class="nfield">Авто/ГОСТ/Большой/Маленький</span> – при первом варианте тип штампа берется с блока вспомогательной рамки в остальных принудительно устанавливается указаный.</p>
<p>Будет предложено ввести название создаваемого листа. По умолчанию имя Лист1 если такой есть к цифре будет прибавляться единица. Выбор <span class="nfield">Настройки</span> позволит переопределить перечисленные выше настройки.</p>
<p>Приглашение выбрать блок вспомогательной рамки </p>
<IMG src="draw_layout_05.png" width="603" height="90" alt="запрос имени листа или настроек">
<p>После выбора создается лист с указанным именем в него вставляется рамка формата, штамп (если указан) и полигональный видовой экран в определённом масштабе повернутый в соответствии с вспомогательной рамкой и границами по тонкой линии вспомогательной рамки. То есть примерно так:</p>
<a href="draw_layout_10.png" ><IMG src="draw_layout_10.png" width="650" alt="Пример оформления листа"></a>
<p>В зависимости от настройки <span class="nfield">Вернуться в модель</span> возвращаемся в модель чтобы еще раз кликнуть на кнопке и выбрать следующую вспомогательную рамку (имя листа автоматом прибавит единичку Например если было План1 при повторной активации по умолчанию именем листа будет План2) или остаемся в листе для до оформления текущего листа. Если листов много очень кстати придется # для автоматической нумерации листов в штампе.</p>
<p>Добавлю только то что сам часто пользуюсь первыми двумя пунктами. Программка третьего писалась скорее из «любви к искусству» чем по необходимости – давно не приходилось оформлять действительно длинный объект. Поэтому тестирование проводилось только в рамках… тестирования. В рабочих целях, по настоящему, не использовалась.</p>
<div class="data"><p>2012.11.13</p></div>